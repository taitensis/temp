---
import BaseLayout from "@/layouts/BaseLayout.astro";
import RecipeCard from "@/components/RecipeCard.astro";
import { getRecipes } from "@/lib/supabase";
import type { Recipe, RecipeFilters } from "@/lib/types";

const query = Astro.url.searchParams.get('q') || '';

let recipes: Recipe[] = [];
if (query) {
  const response = await getRecipes({ search: query } as RecipeFilters, 1, 50); // adjust limit
  recipes = response.data;
}
---

<BaseLayout title="Search Results" lang="en">
  <div class="space-y-6">
    <h1 class="text-4xl font-bold">
      Search Results for "{query}"
    </h1>
    
    {recipes.length === 0 ? (
      <p class="text-muted-foreground">
        No recipes found. Try a different search term.
      </p>
    ) : (
      <div class="recipe-grid">
        {recipes.map((recipe: Recipe) => (
          <RecipeCard recipe={recipe} lang="en" />
        ))}
      </div>
    )}
  </div>
</BaseLayout>